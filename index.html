<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Destiny 2 Armor 3.0 Calculator</title>
<style>
  body { font-family: Arial, sans-serif; background: #d0e7f9; margin: 20px; }
  .section { background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 0 8px rgba(0,0,0,0.1);}
  label { display: block; margin-top: 10px; }
  input[type=number], select { padding: 6px; font-size: 16px; width: 100%; max-width: 200px; }
  button { margin-top: 15px; padding: 10px 15px; font-size: 16px; cursor: pointer; }
  .flex-row { display: flex; flex-wrap: wrap; gap: 10px; }
  .flex-col { flex: 1 1 120px; }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
  }
  th, td {
    border: 1px solid #ccc;
    padding: 8px;
    text-align: left;
  }
  th {
    background: #e0f0ff;
  }
</style>
</head>
<body>

<div class="section">
  <h1>Destiny 2 Armor 3.0 Stat Calculator</h1>
  <p>Calculate your optimal armor builds by selecting your class, desired stats, and customizing armor tiers and archetypes.</p>
</div>

<!-- New Armor Archetype Breakdown Section -->
<div class="section">
  <h2>üõ°Ô∏è Armor Archetype Breakdown</h2>
  <table>
    <thead>
      <tr>
        <th>Archetype</th>
        <th>Primary Stat Focus</th>
        <th>Secondary Stat Focus</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><strong>Paragon</strong></td>
        <td>Super </td>
        <td>Melee </td>
        <td>Boosts Super and Melee regeneration stats, ideal for builds centered on powerful Super abilities and close-range combat.</td>
      </tr>
      <tr>
        <td><strong>Gunner</strong></td>
        <td>Weapons </td>
        <td>Grenade </td>
        <td>Focuses on weapon handling and grenade regeneration. Perfect for aggressive weapon and grenade spammers.</td>
      </tr>
      <tr>
        <td><strong>Brawler</strong></td>
        <td>Melee </td>
        <td>Health </td>
        <td>Strengthens Melee attacks and overall health. Great for tanky melee-focused builds.</td>
      </tr>
      <tr>
        <td><strong>Bulwark</strong></td>
        <td>Health </td>
        <td>Class Ability </td>
        <td>Increases durability and class ability recharge, suited for defensive and support roles.</td>
      </tr>
      <tr>
        <td><strong>Grenadier</strong></td>
        <td>Grenade </td>
        <td>Super </td>
        <td>Prioritizes grenade and Super energy, enabling frequent use of both grenades and Supers.</td>
      </tr>
      <tr>
        <td><strong>Specialist</strong></td>
        <td>Class Ability</td>
        <td>Weapons</td>
        <td>Enhances class ability recharge and weapon handling. Ideal for builds that rely heavily on class skills and weapons.</td>
      </tr>
    </tbody>
  </table>
  <p style="margin-top: 10px; font-style: italic;">
    ‚ö†Ô∏è <em>Note:</em> The actual stat gains vary by armor tier and Masterwork bonuses, so combining archetypes strategically can help you hit your desired stats efficiently.
  </p>
</div>

<div class="section" id="statCalcSection">
  <h2>Stat Calculator (Desired Stats Input)</h2>
  <div class="flex-row" id="statInputs"></div>
  <button id="calcSuggested">Calculate Suggested Build</button>
  <p id="suggestedBuildOutput"></p>
</div>

<div class="section" id="customBuilderSection">
  <h2>Custom Tier/Archetype Builder</h2>
  <label for="classSelect">Class:</label>
  <select id="classSelect">
    <option>Hunter</option>
    <option>Titan</option>
    <option>Warlock</option>
  </select>

  <div id="armorSlots"></div>

  <h3>Estimated Total Stats:</h3>
  <ul id="totalStats"></ul>
</div>

<script>
  const TIERS = [1,2,3,4,5];
  const ARCHETYPES = ['Paragon','Gunner','Brawler','Bulwark','Grenadier','Specialist'];
  const CLASSES = ['Hunter','Titan','Warlock'];
  const STATS = ['Weapon', 'Health', 'Class', 'Grenade', 'Super', 'Melee'];

  // Create stat inputs for calculator
  const statInputsContainer = document.getElementById('statInputs');
  let desiredStats = {};
  STATS.forEach(stat => {
    desiredStats[stat] = 0;
    const div = document.createElement('div');
    div.className = 'flex-col';
    div.innerHTML = `<label>${stat} (0‚Äì200)</label><input type="number" min="0" max="200" value="0" id="stat_${stat}" />`;
    statInputsContainer.appendChild(div);
  });

  // Update desired stats on input
  STATS.forEach(stat => {
    document.getElementById(`stat_${stat}`).addEventListener('input', e => {
      let val = parseInt(e.target.value);
      if(isNaN(val) || val < 0) val = 0;
      else if(val > 200) val = 200;
      desiredStats[stat] = val;
    });
  });

  // Calculate suggested build (dummy logic for demo)
  document.getElementById('calcSuggested').addEventListener('click', () => {
    // TODO: Replace with real matching algorithm
    document.getElementById('suggestedBuildOutput').textContent =
      'Suggested build: 2x T5 Paragon, 2x T4 Gunner, 1x T3 Brawler';
  });

  // Build slots for custom builder
  const armorSlotsDiv = document.getElementById('armorSlots');
  const slotNames = ['Helmet', 'Gauntlets', 'Chest', 'Legs', 'Class Item'];
  let buildSlots = [];

  function createBuildSlot(i) {
    const div = document.createElement('div');
    div.style.marginBottom = '12px';
    div.style.display = 'flex';
    div.style.gap = '10px';
    div.style.alignItems = 'center';

    const label = document.createElement('div');
    label.style.width = '100px';
    label.textContent = slotNames[i];
    div.appendChild(label);

    const tierSelect = document.createElement('select');
    TIERS.forEach(t => {
      const opt = document.createElement('option');
      opt.value = t;
      opt.textContent = 'Tier ' + t;
      tierSelect.appendChild(opt);
    });
    div.appendChild(tierSelect);

    const archetypeSelect = document.createElement('select');
    ARCHETYPES.forEach(a => {
      const opt = document.createElement('option');
      opt.value = a;
      opt.textContent = a;
      archetypeSelect.appendChild(opt);
    });
    div.appendChild(archetypeSelect);

    // Initialize build slot object
    buildSlots[i] = {tier: 5, archetype: ARCHETYPES[0]};
    tierSelect.value = 5;
    archetypeSelect.value = ARCHETYPES[0];

    tierSelect.addEventListener('change', () => {
      buildSlots[i].tier = Number(tierSelect.value);
      updateTotalStats();
    });
    archetypeSelect.addEventListener('change', () => {
      buildSlots[i].archetype = archetypeSelect.value;
      updateTotalStats();
    });

    return div;
  }

  for(let i=0; i<5; i++) {
    armorSlotsDiv.appendChild(createBuildSlot(i));
  }

  // Calculate stats from build - same mock logic as React version
function calculateStatsFromBuild() {
  const stats = {
    Weapons: 0,
    Health: 0,
    Class: 0,
    Grenade: 0,
    Super: 0,
    Melee: 0,
  };

  const tierValues = {
    1: { primary: 16, secondary: 12 },
    2: { primary: 20, secondary: 15 },
    3: { primary: 24, secondary: 18 },
    4: { primary: 30, secondary: 25 },
    5: { primary: 32, secondary: 27 } // Slightly higher than T4 based on "80+" estimate
  };

  buildSlots.forEach(({ tier, archetype }) => {
    const { primary, secondary } = tierValues[tier];

    switch (archetype) {
      case 'Paragon':
        stats.Super += primary;
        stats.Melee += secondary;
        break;
      case 'Gunner':
        stats.Weapons += primary;
        stats.Grenade += secondary;
        break;
      case 'Brawler':
        stats.Melee += primary;
        stats.Health += secondary;
        break;
      case 'Bulwark':
        stats.Health += primary;
        stats.Class += secondary;
        break;
      case 'Grenadier':
        stats.Grenade += primary;
        stats.Super += secondary;
        break;
      case 'Specialist':
        stats.Class += primary;
        stats.Weapons += secondary;
        break;
    }
  });

  return stats;
}

  function updateTotalStats() {
    const totals = calculateStatsFromBuild();
    const ul = document.getElementById('totalStats');
    ul.innerHTML = '';
    STATS.forEach(stat => {
      const li = document.createElement('li');
      li.textContent = `${stat}: ${totals[stat]}`;
      ul.appendChild(li);
    });
  }

  // Initialize total stats display
  updateTotalStats();

</script>

</body>
</html>
